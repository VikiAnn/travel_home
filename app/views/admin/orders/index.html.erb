<% if current_user.admin? %>
  <div class="btn-group btn-group-justified role-filters col-md-offset-3" role="group">
    <a class="btn btn-default" href="<%= admin_reservations_path %>">All</a>
    <a class="btn btn-default" href="<%= reserved_admin_reservations_path %>">Reserved</a>
    <a class="btn btn-default" href="<%= paid_admin_reservations_path %>">Paid</a>
    <a class="btn btn-default" href="<%= completed_admin_reservations_path %>">Completed</a>
    <a class="btn btn-default" href="<%= cancelled_admin_reservations_path %>">Cancelled</a>
  </div>
<% end %>

<div class="edit-form">
  <table class="table table-hover">
    <thead>
      <th>Date</th>
      <% if current_user.admin? %>
        <th>User (id)</th>
      <% end %>
      <th>Total</th>
      <th>Status</th>
      <th>Actions</th>
    </thead>
    <tbody>
      <% @reservations.each do |reservation| %>
      <tr class="reservation reservation_<%= reservation.id %>">
        <% if current_user.admin? %>
          <td class="date"><%= link_to reservation.updated_at, admin_reservation_path(reservation) %></td>
          <td class="user"><%= link_to "#{reservation.user.name} (#{reservation.user.id})", user_path(reservation.user) %></td>
        <% else %>
          <td class="date"><%= link_to reservation.updated_at, reservation_path(reservation) %></td>
        <% end %>
        <td class="total">$<%= reservation.total %></td>
        <td class="status"><%= reservation.status %></td>
        <td>
          <div class="btn-group">
            <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-expanded="false">
              Actions <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" role="menu">
              <% if reservation.reserved? %>
                <li><%= link_to "Mark as paid", pay_admin_reservation_path(reservation), method: :put %></li>
              <% elsif reservation.paid? %>
                <li><%= link_to "Mark as completed", complete_admin_reservation_path(reservation), method: :put %></li>
              <% else %>
                <li><a>[None]</a></li>
              <% end %>

              <% if reservation.reserved? || reservation.paid? %>
                <li><%= link_to "Cancel Reservation", cancel_admin_reservation_path(reservation), method: :put %></li>
              <% end %>
            </ul>
          </div>
        </td>
      </tr>
      <% end %>
    </tbody>
  </table>
</div>
